{
    "constants": {
    "sample_id": "X53J7F"
    },

    "applications": [
    {
        "id": "bwa",
        "docker_image": "isaacliao/bwa-0.7.7"
    }
    ],

    "remote_file_locations":[
    {
        "id": "hellofilesource",
        "comment": "This is a publicly available file in Azure Blob storage.",
        "path": "https://scgs.blob.core.windows.net/public/hellofile.txt"
    },
    {
        "id": "helloworldfiledestination",
        "comment": "The file will be written to Azure Blob storage",
        "account": "scgs",
        "container": "testcontainer",
        "blob_id": "helloworld.txt"
    }
    ],
    

    "files": [
        {
            "comment": "This file will be used in several tasks in a session, but will not be saved to persistent storage.",
            "id": "worldfile",
            "local_path": "words/world_${sample_id}.txt"
        },
        
        {
            "comment": "This file already exists and needs to be imported.",
            "id": "hellofile",
            "local_path": "words/hello_${sample_id}.txt",
            "import_from": "hellofilesource"
        },
        {
            "comment": "This results file will be created by the analysis run.",
            "id": "helloworldfile",
            "local_path": "results/helloworld_${sample_id}.txt",
            "save_to": "helloworldfiledestination"
        }
    ],

    "sessions":[
        {
            "id": "helloworldsession",
            "comment": "A session is a set of tasks that share a common working directory, typically run on a single machine",
            "session_resource_set": "default_session_resource_set",
            
            "input_file_ids": ["hellofile"],
            "output_file_ids": ["helloworldfile"],
            
            "step_ids": [
                "worldstep",
                "helloworldstep"
            ]
        }

    ],

    "steps":[
        {
            "id": "worldstep",
            "comment": "Even though worldfile is only used inside the session, we declare it to make it clear that this step runs before helloworldstep",
            "constants": {
            "world_text": "world"
            },
            "command": "echo ${world_text} > ${worldfile}",
            "application": "bwa",
            "step_resource_set": "default_step_resources"
        },
        {
            "id": "helloworldstep",
            "comment": "This step concatenates hello with world to write hello world. It won't run until that step finishes because it needs worldfile.",
            "constants": {
            "space_char": " "
            },
            "command": "cat ${hellofile}${space_char}${worldfile} > ${helloworldfile}",
            "application": "bwa",
            "step_resource_set": "default_step_resource_set"
        }
    ],

    "session_resource_sets": [
        {
            "id": "default_session_resource_set",
            "comment": "These are minimum resources for the whole session, i.e. requirements for a VM and mounted storage where a session will run",
            "disk_space": "50k",
            "memory": "16G",
            "cores": 1
        }
    ],

    "step_resource_sets": [
        {
            "id": "default_step_resource_set",
            "memory": "1G",
            "cores": 1
        }
    ],
    
    "pipeline": {

        "files": [
            "hellofile",
            "worldfile",
            "helloworldfile"
        ],

        "sessions": [
            "helloworldsession"
        ]
    }
}
