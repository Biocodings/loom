{
    "constants": {
        "GATKkey": "stanford.edu.key",
        "GATKthreads": "4",
        "bwa_container": "isaacliao/bwa-0.7.4",
        "chromosome": "chr22",
        "dbsnp": "dbsnp_138.hg19.vcf",
        "dockermount": "/working_dir",
        "fix_bai_name_container": "isaacliao/fix_bai_name",
        "gatk_container": "isaacliao/gatk-3.1.1",
        "goldindels": "Mills_and_1000G_gold_standard.indels.hg19.vcf",
        "hapmap": "hapmap_3.3.hg19.vcf",
        "input_dir": "/home/xppf/NA12878-Macrogen",
        "inputbamfile": "NA12878-Macrogen-chr22.bam",
        "omni": "1000G_omni2.5.hg19.vcf",
        "outputbamfile": "genome.recal.bam",
        "outputvcffile": "genome.recal.vcf",
        "phase1indels": "1000G_phase1.indels.hg19.vcf",
        "phase1snps": "1000G_phase1.snps.high_confidence.hg19.vcf",
        "picard_container": "isaacliao/picard-1.32",
        "reference": "ucsc.hg19.fasta",
        "reference_dict": "ucsc.hg19.dict",
        "resource_dir": "/home/xppf/medgap-resources",
        "samplename": "NA12878",
        "samtools_container": "isaacliao/samtools-0.1.19",
        "tabix_container": "isaacliao/tabix-0.2.5"
    },
    "requester": "someone@example.net",
    "workflows": [
        {
            "input_files": [
                "${input_dir}/${inputbamfile}",
                "${resource_dir}/${reference}",
                "${resource_dir}/${reference}.bwt",
                "${resource_dir}/${reference}.pac",
                "${resource_dir}/${reference}.ann",
                "${resource_dir}/${reference}.amb",
                "${resource_dir}/${reference}.sa",
                "${resource_dir}/${reference}.fai",
                "${resource_dir}/${reference_dict}",
                "${resource_dir}/${goldindels}",
                "${resource_dir}/${goldindels}.idx",
                "${resource_dir}/${phase1indels}",
                "${resource_dir}/${phase1indels}.idx",
                "${resource_dir}/${phase1snps}",
                "${resource_dir}/${phase1snps}.idx",
                "${resource_dir}/${dbsnp}",
                "${resource_dir}/${dbsnp}.idx",
                "${resource_dir}/${hapmap}",
                "${resource_dir}/${hapmap}.idx",
                "${resource_dir}/${omni}",
                "${resource_dir}/${omni}.idx",
                "${resource_dir}/${GATKkey}"
            ],
            "name": "medgap_poc",
            "steps": [
                {
                    "command": "samtools bam2fq ${inputbamfile} > ${samplename}.fastq",
                    "environment": {
                        "docker_image": "${samtools_container}"
                    },
                    "input_ports": [
                        {
                            "file_path": "${inputbamfile}",
                            "name": "bam2fq_in"
                        }
                    ],
                    "name": "bam2fq",
                    "output_ports": [
                        {
                            "file_path": "${samplename}.fastq",
                            "name": "bam2fq_out"
                        }
                    ],
                    "resources": {
                        "cores": "1",
                        "memory": "10GB"
                    }
                },
                {
                    "command": "bwa mem -CMp -t 4 -R \"@RG\\tID:0\\tLB:Library\\tPL:Illumina\\tSM:${samplename}\" ${reference} ${samplename}.fastq > ${samplename}.bwa.sam",
                    "environment": {
                        "docker_image": "${bwa_container}"
                    },
                    "input_ports": [
                        {
                            "file_path": "${samplename}.fastq",
                            "name": "align_in"
                        },
                        {
                            "file_path": "${reference}.bwt",
                            "name": "reference_index_bwt"
                        },
                        {
                            "file_path": "${reference}.pac",
                            "name": "reference_index_pac"
                        },
                        {
                            "file_path": "${reference}.sa",
                            "name": "reference_index_sa"
                        },
                        {
                            "file_path": "${reference}.ann",
                            "name": "reference_index_ann"
                        },
                        {
                            "file_path": "${reference}.amb",
                            "name": "reference_index_amb"
                        }
                    ],
                    "name": "align",
                    "output_ports": [
                        {
                            "file_path": "${samplename}.bwa.sam",
                            "name": "align_out"
                        }
                    ],
                    "resources": {
                        "cores": "4",
                        "memory": "10GB"
                    }
                },
                {
                    "command": "samtools view -Sbt ${reference}.fai -o ${samplename}.bwa.bam ${samplename}.bwa.sam",
                    "environment": {
                        "docker_image": "${samtools_container}"
                    },
                    "input_ports": [
                        {
                            "file_path": "${samplename}.bwa.sam",
                            "name": "samtobam_in"
                        },
                        {
                            "file_path": "${reference}.fai",
                            "name": "reference_index_fai"
                        }
                    ],
                    "name": "samtobam",
                    "output_ports": [
                        {
                            "file_path": "${samplename}.bwa.bam",
                            "name": "samtobam_out"
                        }
                    ],
                    "resources": {
                        "cores": "4",
                        "memory": "10GB"
                    }
                },
                {
                    "command": "java -Xms8g -Xmx8g -jar /opt/picard-tools-1.32/MergeSamFiles.jar TMP_DIR=${dockermount} INPUT=${samplename}.bwa.bam USE_THREADING=true CREATE_INDEX=true OUTPUT=${samplename}.bwa.sorted.bam",
                    "environment": {
                        "docker_image": "${picard_container}"
                    },
                    "input_ports": [
                        {
                            "file_path": "${samplename}.bwa.bam",
                            "name": "mergeinputbams_in"
                        }
                    ],
                    "name": "mergeinputbams",
                    "output_ports": [
                        {
                            "file_path": "${samplename}.bwa.sorted.bam",
                            "name": "mergeinputbams_out"
                        }
                    ],
                    "resources": {
                        "cores": "4",
                        "memory": "10GB"
                    }
                },
                {
                    "command": "samtools index ${samplename}.bwa.sorted.bam",
                    "environment": {
                        "docker_image": "${samtools_container}"
                    },
                    "input_ports": [
                        {
                            "file_path": "${samplename}.bwa.sorted.bam",
                            "name": "indexbam_in"
                        }
                    ],
                    "name": "indexbam",
                    "output_ports": [
                        {
                            "file_path": "${samplename}.bwa.sorted.bam.bai",
                            "name": "indexbam_out"
                        }
                    ],
                    "resources": {
                        "cores": "4",
                        "memory": "10GB"
                    }
                },
                {
                    "command": "samtools view ${samplename}.bwa.sorted.bam ${chromosome} -bo ${chromosome}.bam",
                    "environment": {
                        "docker_image": "${samtools_container}"
                    },
                    "input_ports": [
                        {
                            "file_path": "${samplename}.bwa.sorted.bam",
                            "name": "extractchromosome_in"
                        },
                        {
                            "file_path": "${samplename}.bwa.sorted.bam.bai",
                            "name": "extractchromosome_index_in"
                        }
                    ],
                    "name": "extractchromosome",
                    "output_ports": [
                        {
                            "file_path": "${chromosome}.bam",
                            "name": "extractchromosome_out"
                        }
                    ],
                    "resources": {
                        "cores": "4",
                        "memory": "10GB"
                    }
                },
                {
                    "command": "samtools index ${chromosome}.bam",
                    "environment": {
                        "docker_image": "${samtools_container}"
                    },
                    "input_ports": [
                        {
                            "file_path": "${chromosome}.bam",
                            "name": "indexchromosomebam_in"
                        }
                    ],
                    "name": "indexchromosomebam",
                    "output_ports": [
                        {
                            "file_path": "${chromosome}.bam.bai",
                            "name": "indexchromosomebam_out"
                        }
                    ],
                    "resources": {
                        "cores": "4",
                        "memory": "10GB"
                    }
                },
                {
                    "command": "python /opt/fix_bai_name.py ${chromosome}.bam.bai",
                    "environment": {
                        "docker_image": "${fix_bai_name_container}"
                    },
                    "input_ports": [
                        {
                            "file_path": "${chromosome}.bam.bai",
                            "name": "fixindexnamechromosome_in"
                        }
                    ],
                    "name": "fixindexnamechromosome",
                    "output_ports": [
                        {
                            "file_path": "${chromosome}.bai",
                            "name": "fixindexnamechromosome_out"
                        }
                    ],
                    "resources": {
                        "cores": "4",
                        "memory": "10GB"
                    }
                },
                {
                    "command": "java -Xms5g -Xmx5g -jar /opt/picard-tools-1.32/MarkDuplicates.jar TMP_DIR=${dockermount} I=${chromosome}.bam O=${chromosome}.nodup.bam M=${chromosome}.bam.metrics VALIDATION_STRINGENCY=SILENT ASSUME_SORTED=true REMOVE_DUPLICATES=false",
                    "environment": {
                        "docker_image": "${picard_container}"
                    },
                    "input_ports": [
                        {
                            "file_path": "${chromosome}.bam",
                            "name": "markduplicates_in"
                        }
                    ],
                    "name": "markduplicates",
                    "output_ports": [
                        {
                            "file_path": "${chromosome}.nodup.bam",
                            "name": "markduplicates_out"
                        },
                        {
                            "file_path": "${chromosome}.bam.metrics",
                            "name": "markduplicates_metrics_out"
                        }
                    ],
                    "resources": {
                        "cores": "4",
                        "memory": "10GB"
                    }
                },
                {
                    "command": "samtools index ${chromosome}.nodup.bam",
                    "environment": {
                        "docker_image": "${samtools_container}"
                    },
                    "input_ports": [
                        {
                            "file_path": "${chromosome}.nodup.bam",
                            "name": "indexnodupbam_in"
                        }
                    ],
                    "name": "indexnodupbam",
                    "output_ports": [
                        {
                            "file_path": "${chromosome}.nodup.bam.bai",
                            "name": "indexnodupbam_out"
                        }
                    ],
                    "resources": {
                        "cores": "4",
                        "memory": "10GB"
                    }
                },
                {
                    "command": "python /opt/fix_bai_name.py ${chromosome}.nodup.bam.bai",
                    "environment": {
                        "docker_image": "${fix_bai_name_container}"
                    },
                    "input_ports": [
                        {
                            "file_path": "${chromosome}.nodup.bam.bai",
                            "name": "fixindexnamenodup_in"
                        }
                    ],
                    "name": "fixindexnamenodup",
                    "output_ports": [
                        {
                            "file_path": "${chromosome}.nodup.bai",
                            "name": "fixindexnamenodup_out"
                        }
                    ],
                    "resources": {
                        "cores": "4",
                        "memory": "10GB"
                    }
                },
                {
                    "command": "java -Xms8g -Xmx8g -jar /opt/GenomeAnalysisTK.jar -T RealignerTargetCreator -I ${chromosome}.nodup.bam -R ${reference} -o ${chromosome}.realn.intervals -L ${chromosome} -known ${goldindels} -known ${phase1indels} -et NO_ET -K ${GATKkey} -nt ${GATKthreads}",
                    "environment": {
                        "docker_image": "${gatk_container}"
                    },
                    "input_ports": [
                        {
                            "file_path": "${chromosome}.nodup.bam",
                            "name": "findtargets_in"
                        },
                        {
                            "file_path": "${chromosome}.nodup.bai",
                            "name": "findtargets_bai_in"
                        },
                        {
                            "file_path": "${reference}",
                            "name": "findtargets_reference_in"
                        },
                        {
                            "file_path": "${reference}.fai",
                            "name": "findtargets_reference_fai_in"
                        },
                        {
                            "file_path": "${reference_dict}",
                            "name": "findtargets_reference_dict_in"
                        },
                        {
                            "file_path": "${goldindels}",
                            "name": "findtargets_goldindels_in"
                        },
                        {
                            "file_path": "${goldindels}.idx",
                            "name": "findtargets_goldindels_idx_in"
                        },
                        {
                            "file_path": "${phase1indels}",
                            "name": "findtargets_phase1indels_in"
                        },
                        {
                            "file_path": "${GATKkey}",
                            "name": "findtargets_GATKkey_in"
                        }
                    ],
                    "name": "findtargets",
                    "output_ports": [
                        {
                            "file_path": "${chromosome}.realn.intervals",
                            "name": "findtargets_out"
                        }
                    ],
                    "resources": {
                        "cores": "4",
                        "memory": "10GB"
                    }
                },
                {
                    "command": "java -Xms8g -Xmx8g -Djava.io.tmpdir=${dockermount} -jar /opt/GenomeAnalysisTK.jar -T IndelRealigner -I ${chromosome}.nodup.bam -R ${reference} -o ${chromosome}.realn.bam -L ${chromosome} -targetIntervals ${chromosome}.realn.intervals -known ${goldindels} -known ${phase1indels} -et NO_ET -K ${GATKkey}",
                    "environment": {
                        "docker_image": "${gatk_container}"
                    },
                    "input_ports": [
                        {
                            "file_path": "${chromosome}.realn.intervals",
                            "name": "realign_in"
                        },
                        {
                            "file_path": "${chromosome}.nodup.bam",
                            "name": "realign_nodup_in"
                        },
                        {
                            "file_path": "${chromosome}.nodup.bai",
                            "name": "realign_nodup_bai_in"
                        },
                        {
                            "file_path": "${reference}",
                            "name": "realign_reference_in"
                        },
                        {
                            "file_path": "${reference}.fai",
                            "name": "realign_reference_fai_in"
                        },
                        {
                            "file_path": "${goldindels}",
                            "name": "realign_goldindels_in"
                        },
                        {
                            "file_path": "${goldindels}.idx",
                            "name": "realign_goldindels_idx_in"
                        },
                        {
                            "file_path": "${phase1indels}",
                            "name": "realign_phase1indels_in"
                        },
                        {
                            "file_path": "${phase1indels}.idx",
                            "name": "realign_phase1indels_idx_in"
                        },
                        {
                            "file_path": "${GATKkey}",
                            "name": "realign_GATKkey_in"
                        }
                    ],
                    "name": "realign",
                    "output_ports": [
                        {
                            "file_path": "${chromosome}.realn.bam",
                            "name": "realign_out"
                        }
                    ],
                    "resources": {
                        "cores": "4",
                        "memory": "10GB"
                    }
                },
                {
                    "command": "java -Xms8g -Xmx8g -jar /opt/picard-tools-1.32/FixMateInformation.jar TMP_DIR=${dockermount} INPUT=${chromosome}.realn.bam OUTPUT=${chromosome}.realn.fixed.bam VALIDATION_STRINGENCY=SILENT SORT_ORDER=coordinate",
                    "environment": {
                        "docker_image": "${picard_container}"
                    },
                    "input_ports": [
                        {
                            "file_path": "${chromosome}.realn.bam",
                            "name": "fixmatepairs_in"
                        }
                    ],
                    "name": "fixmatepairs",
                    "output_ports": [
                        {
                            "file_path": "${chromosome}.realn.fixed.bam",
                            "name": "fixmatepairs_out"
                        }
                    ],
                    "resources": {
                        "cores": "4",
                        "memory": "10GB"
                    }
                },
                {
                    "command": "samtools index ${chromosome}.realn.fixed.bam",
                    "environment": {
                        "docker_image": "${samtools_container}"
                    },
                    "input_ports": [
                        {
                            "file_path": "${chromosome}.realn.fixed.bam",
                            "name": "indexrealnbam_in"
                        }
                    ],
                    "name": "indexrealnbam",
                    "output_ports": [
                        {
                            "file_path": "${chromosome}.realn.fixed.bam.bai",
                            "name": "indexrealnbam_out"
                        }
                    ],
                    "resources": {
                        "cores": "4",
                        "memory": "10GB"
                    }
                },
                {
                    "command": "python /opt/fix_bai_name.py ${chromosome}.realn.fixed.bam.bai",
                    "environment": {
                        "docker_image": "${fix_bai_name_container}"
                    },
                    "input_ports": [
                        {
                            "file_path": "${chromosome}.realn.fixed.bam.bai",
                            "name": "fixindexrealn_in"
                        }
                    ],
                    "name": "fixindexrealn",
                    "output_ports": [
                        {
                            "file_path": "${chromosome}.realn.fixed.bai",
                            "name": "fixindexrealn_out"
                        }
                    ],
                    "resources": {
                        "cores": "4",
                        "memory": "10GB"
                    }
                },
                {
                    "command": "java -Xms5g -Xmx5g -jar /opt/GenomeAnalysisTK.jar -T BaseRecalibrator -I ${chromosome}.realn.fixed.bam -R ${reference} -o ${chromosome}.recal.grp -knownSites ${goldindels} -knownSites ${phase1indels} -knownSites ${dbsnp} -K ${GATKkey} -nct ${GATKthreads}",
                    "environment": {
                        "docker_image": "${gatk_container}"
                    },
                    "input_ports": [
                        {
                            "file_path": "${chromosome}.realn.fixed.bam",
                            "name": "bqsr_in"
                        },
                        {
                            "file_path": "${chromosome}.realn.fixed.bai",
                            "name": "bqsr_index_in"
                        },
                        {
                            "file_path": "${reference}",
                            "name": "bqsr_reference_in"
                        },
                        {
                            "file_path": "${reference}.fai",
                            "name": "bqsr_reference_fai_in"
                        },
                        {
                            "file_path": "${goldindels}",
                            "name": "bqsr_goldindels_in"
                        },
                        {
                            "file_path": "${goldindels}.idx",
                            "name": "bqsr_goldindels_idx_in"
                        },
                        {
                            "file_path": "${phase1indels}",
                            "name": "bqsr_phase1indels_in"
                        },
                        {
                            "file_path": "${phase1indels}.idx",
                            "name": "bqsr_phase1indels_idx_in"
                        },
                        {
                            "file_path": "${GATKkey}",
                            "name": "bqsr_GATKkey_in"
                        },
                        {
                            "file_path": "${dbsnp}",
                            "name": "bqsr_dbsnp_in"
                        },
                        {
                            "file_path": "${dbsnp}.idx",
                            "name": "bqsr_dbsnp_idx_in"
                        }
                    ],
                    "name": "bqsr",
                    "output_ports": [
                        {
                            "file_path": "${chromosome}.recal.grp",
                            "name": "bqsr_out"
                        }
                    ],
                    "resources": {
                        "cores": "4",
                        "memory": "10GB"
                    }
                },
                {
                    "command": "java -Xms5g -Xmx5g -jar /opt/GenomeAnalysisTK.jar -R ${reference} -I ${chromosome}.realn.fixed.bam -o ${chromosome}.recal.bam -T PrintReads -BQSR ${chromosome}.recal.grp -K ${GATKkey} -nct ${GATKthreads}",
                    "environment": {
                        "docker_image": "${gatk_container}"
                    },
                    "input_ports": [
                        {
                            "file_path": "${chromosome}.realn.fixed.bam",
                            "name": "printreads_in"
                        },
                        {
                            "file_path": "${chromosome}.realn.fixed.bai",
                            "name": "printreads_index_in"
                        },
                        {
                            "file_path": "${reference}",
                            "name": "printreads_reference_in"
                        },
                        {
                            "file_path": "${reference}.fai",
                            "name": "printreads_reference_fai_in"
                        },
                        {
                            "file_path": "${GATKkey}",
                            "name": "printreads_GATKkey_in"
                        },
                        {
                            "file_path": "${chromosome}.recal.grp",
                            "name": "printreads_bqsr_in"
                        }
                    ],
                    "name": "printreads",
                    "output_ports": [
                        {
                            "file_path": "${chromosome}.recal.bam",
                            "name": "printreads_out"
                        }
                    ],
                    "resources": {
                        "cores": "4",
                        "memory": "10GB"
                    }
                },
                {
                    "command": "samtools index ${chromosome}.recal.bam",
                    "environment": {
                        "docker_image": "${samtools_container}"
                    },
                    "input_ports": [
                        {
                            "file_path": "${chromosome}.recal.bam",
                            "name": "indexbamrecal_in"
                        }
                    ],
                    "name": "indexbamrecal",
                    "output_ports": [
                        {
                            "file_path": "${chromosome}.recal.bam.bai",
                            "name": "indexbamrecal_out"
                        }
                    ],
                    "resources": {
                        "cores": "4",
                        "memory": "10GB"
                    }
                },
                {
                    "command": "python /opt/fix_bai_name.py ${chromosome}.recal.bam.bai",
                    "environment": {
                        "docker_image": "${fix_bai_name_container}"
                    },
                    "input_ports": [
                        {
                            "file_path": "${chromosome}.recal.bam.bai",
                            "name": "fixindexrecal_in"
                        }
                    ],
                    "name": "fixindexrecal",
                    "output_ports": [
                        {
                            "file_path": "${chromosome}.recal.bai",
                            "name": "fixindexrecal_out"
                        }
                    ],
                    "resources": {
                        "cores": "1",
                        "memory": "1GB"
                    }
                },
                {
                    "command": "java -Xmx8g -Xms8g -Djava.io.tmpdir=${dockermount} -jar /opt/GenomeAnalysisTK.jar -T HaplotypeCaller -R ${reference} -I ${chromosome}.recal.bam --dbsnp ${dbsnp} -o ${chromosome}.gatk.vcf.hc.vcf -stand_call_conf 20.0 -stand_emit_conf 10.0 --genotyping_mode DISCOVERY -nct ${GATKthreads}",
                    "environment": {
                        "docker_image": "${gatk_container}"
                    },
                    "input_ports": [
                        {
                            "file_path": "${chromosome}.recal.bam",
                            "name": "haplotypecaller_in"
                        },
                        {
                            "file_path": "${chromosome}.recal.bai",
                            "name": "haplotypecaller_index_in"
                        },
                        {
                            "file_path": "${reference}",
                            "name": "haplotypecaller_reference_in"
                        },
                        {
                            "file_path": "${reference}.fai",
                            "name": "haplotypecaller_reference_fai_in"
                        }
                    ],
                    "name": "haplotypecaller",
                    "output_ports": [
                        {
                            "file_path": "${chromosome}.gatk.vcf.hc.vcf",
                            "name": "haplotypecaller_out"
                        }
                    ],
                    "resources": {
                        "cores": "4",
                        "memory": "10GB"
                    }
                },
                {
                    "command": "java -Xmx8g -Xms8g -jar /opt/GenomeAnalysisTK.jar -T SelectVariants -R ${reference} -V ${chromosome}.gatk.vcf.hc.vcf -o ${chromosome}.gatk.vcf.snp -selectType SNP",
                    "environment": {
                        "docker_image": "${gatk_container}"
                    },
                    "input_ports": [
                        {
                            "file_path": "${chromosome}.gatk.vcf.hc.vcf",
                            "name": "selectsnps_in"
                        },
                        {
                            "file_path": "${reference}",
                            "name": "selectsnps_reference_in"
                        },
                        {
                            "file_path": "${reference}.fai",
                            "name": "selectsnps_reference_fai_in"
                        }
                    ],
                    "name": "selectsnps",
                    "output_ports": [
                        {
                            "file_path": "${chromosome}.gatk.vcf.snp",
                            "name": "selectsnps_out"
                        }
                    ],
                    "resources": {
                        "cores": "4",
                        "memory": "10GB"
                    }
                },
                {
                    "command": "java -Xmx8g -Xms8g -jar /opt/GenomeAnalysisTK.jar -T SelectVariants -R ${reference} -V ${chromosome}.gatk.vcf.hc.vcf -o ${chromosome}.gatk.vcf.indel -selectType INDEL",
                    "environment": {
                        "docker_image": "${gatk_container}"
                    },
                    "input_ports": [
                        {
                            "file_path": "${chromosome}.gatk.vcf.hc.vcf",
                            "name": "selectindels_in"
                        },
                        {
                            "file_path": "${reference}",
                            "name": "selectindels_reference_in"
                        },
                        {
                            "file_path": "${reference}.fai",
                            "name": "selectindels_reference_fai_in"
                        }
                    ],
                    "name": "selectindels",
                    "output_ports": [
                        {
                            "file_path": "${chromosome}.gatk.vcf.indel",
                            "name": "selectindels_out"
                        }
                    ],
                    "resources": {
                        "cores": "4",
                        "memory": "10GB"
                    }
                },
                {
                    "command": "java -Xmx8g -Xms8g -jar /opt/GenomeAnalysisTK.jar -R ${reference} -T CombineVariants --variant ${chromosome}.gatk.vcf.snp --variant ${chromosome}.gatk.vcf.indel -o ${chromosome}.gatk.vcf",
                    "environment": {
                        "docker_image": "${gatk_container}"
                    },
                    "input_ports": [
                        {
                            "file_path": "${chromosome}.gatk.vcf.snp",
                            "name": "combinesnpsindels_snps_in"
                        },
                        {
                            "file_path": "${chromosome}.gatk.vcf.indel",
                            "name": "combinesnpsindels_indels_in"
                        },
                        {
                            "file_path": "${reference}",
                            "name": "combinesnpsindels_reference_in"
                        },
                        {
                            "file_path": "${reference}.fai",
                            "name": "combinesnpindels_reference_fai_in"
                        }
                    ],
                    "name": "combinesnpsindels",
                    "output_ports": [
                        {
                            "file_path": "${chromosome}.gatk.vcf",
                            "name": "combinesnpsindels_out"
                        }
                    ],
                    "resources": {
                        "cores": "4",
                        "memory": "10GB"
                    }
                },
                {
                    "command": "java -Xms5g -Xmx5g -jar /opt/picard-tools-1.32/MergeSamFiles.jar TMP_DIR=${dockermount} INPUT=${chromosome}.recal.bam USE_THREADING=true CREATE_INDEX=true OUTPUT=${outputbamfile}",
                    "environment": {
                        "docker_image": "${picard_container}"
                    },
                    "input_ports": [
                        {
                            "file_path": "${chromosome}.recal.bam",
                            "name": "mergechromosomebams_in"
                        },
                        {
                            "file_path": "${chromosome}.recal.bai",
                            "name": "mergechromosomebams_bai_in"
                        }
                    ],
                    "name": "mergechromosomebams",
                    "output_ports": [
                        {
                            "file_path": "${outputbamfile}",
                            "name": "mergechromosomebams_out"
                        }
                    ],
                    "resources": {
                        "cores": "1",
                        "memory": "6GB"
                    }
                },
                {
                    "command": "java -Xmx8g -Xms8g -jar /opt/GenomeAnalysisTK.jar -R ${reference} -T CombineVariants --variant:VCF ${dockermount}/${chromosome}.gatk.vcf -o ${samplename}.gatk.vcf",
                    "environment": {
                        "docker_image": "${gatk_container}"
                    },
                    "input_ports": [
                        {
                            "file_path": "${chromosome}.gatk.vcf",
                            "name": "combinevcfs_in"
                        },
                        {
                            "file_path": "${reference}",
                            "name": "combinevcfs_reference_in"
                        },
                        {
                            "file_path": "${reference}.fai",
                            "name": "combinevcfs_reference_fai_in"
                        }
                    ],
                    "name": "combinevcfs",
                    "output_ports": [
                        {
                            "file_path": "${samplename}.gatk.vcf",
                            "name": "combinevcfs_out"
                        }
                    ],
                    "resources": {
                        "cores": "1",
                        "memory": "10GB"
                    }
                },
                {
                    "command": "java -Xmx6g -Xms6g -jar /opt/GenomeAnalysisTK.jar -T SelectVariants -R ${reference} -V ${samplename}.gatk.vcf -o ${samplename}.snp.vcf -selectType SNP",
                    "environment": {
                        "docker_image": "${gatk_container}"
                    },
                    "input_ports": [
                        {
                            "file_path": "${samplename}.gatk.vcf",
                            "name": "selectsnpsforvqsr_in"
                        },
                        {
                            "file_path": "${reference}",
                            "name": "selectsnpsforvqsr_reference_in"
                        },
                        {
                            "file_path": "${reference}.fai",
                            "name": "selectsnpsforvqsr_reference_fai_in"
                        }
                    ],
                    "name": "selectsnpsforvqsr",
                    "output_ports": [
                        {
                            "file_path": "${samplename}.snp.vcf",
                            "name": "selectsnpsforvqsr_out"
                        }
                    ],
                    "resources": {
                        "cores": "1",
                        "memory": "8GB"
                    }
                },
                {
                    "command": "java -Xmx6g -Xms6g -jar /opt/GenomeAnalysisTK.jar -T VariantRecalibrator -R ${reference} -input ${samplename}.snp.vcf -resource:hapmap,known=false,training=true,truth=true,prior=15.0 ${hapmap} -resource:omni,known=false,training=true,truth=true,prior=12.0 ${omni} -resource:1000G,known=false,training=true,truth=false,prior=10.0 ${phase1snps} -resource:dbsnp,known=true,training=false,truth=false,prior=2.0 ${dbsnp} -an DP -an QD -an FS -an MQRankSum -an ReadPosRankSum -tranche 100.0 -tranche 99.9 -tranche 99.0 -tranche 90.0 -mode SNP -recalFile ${samplename}.tmp.snp.vcf -tranchesFile ${samplename}.tranches.gatk.snp.recal.csv -nt ${GATKthreads} -rscriptFile ${samplename}.gatk.recal.snp.R",
                    "environment": {
                        "docker_image": "${gatk_container}"
                    },
                    "input_ports": [
                        {
                            "file_path": "${samplename}.snp.vcf",
                            "name": "trainvqsrforsnps_in"
                        },
                        {
                            "file_path": "${reference}",
                            "name": "trainvqsrforsnps_reference_in"
                        },
                        {
                            "file_path": "${reference}.fai",
                            "name": "trainvqsrforsnps_reference_fai_in"
                        },
                        {
                            "file_path": "${hapmap}",
                            "name": "trainvqsrforsnps_hapmap_in"
                        },
                        {
                            "file_path": "${hapmap}.idx",
                            "name": "trainvqsrforsnps_hapmap_idx_in"
                        },
                        {
                            "file_path": "${omni}",
                            "name": "trainvqsrforsnps_omni_in"
                        },
                        {
                            "file_path": "${omni}.idx",
                            "name": "trainvqsrforsnps_omni_idx_in"
                        },
                        {
                            "file_path": "${phase1snps}",
                            "name": "trainvqsrforsnps_phase1snps_in"
                        },
                        {
                            "file_path": "${phase1snps}.idx",
                            "name": "trainvqsrforsnps_phase1snps_idx_in"
                        },
                        {
                            "file_path": "${dbsnp}",
                            "name": "trainvqsrforsnps_dbsnp_in"
                        },
                        {
                            "file_path": "${dbsnp}.idx",
                            "name": "trainvqsrforsnps_dbsnp_idx_in"
                        }
                    ],
                    "name": "trainvqsrforsnps",
                    "output_ports": [
                        {
                            "file_path": "${samplename}.tmp.snp.vcf",
                            "name": "trainvqsrforsnps_recal_out"
                        },
                        {
                            "file_path": "${samplename}.tranches.gatk.snp.recal.csv",
                            "name": "trainvqsrforsnps_tranches_out"
                        },
                        {
                            "file_path": "${samplename}.gatk.recal.snp.R",
                            "name": "trainvqsrforsnps_rscript_out"
                        }
                    ],
                    "resources": {
                        "cores": "4",
                        "memory": "8GB"
                    }
                },
                {
                    "command": "java -Xmx3g -Xms3g -jar /opt/GenomeAnalysisTK.jar -T ApplyRecalibration -R ${reference} -input ${samplename}.snp.vcf --ts_filter_level 99.0 -tranchesFile ${samplename}.tranches.gatk.snp.recal.csv -recalFile ${samplename}.tmp.snp.vcf -o ${samplename}.vqsr.snp.vcf --mode SNP",
                    "environment": {
                        "docker_image": "${gatk_container}"
                    },
                    "input_ports": [
                        {
                            "file_path": "${samplename}.snp.vcf",
                            "name": "vqsrsnps_in"
                        },
                        {
                            "file_path": "${reference}",
                            "name": "vqsrsnps_reference_in"
                        },
                        {
                            "file_path": "${reference}.fai",
                            "name": "vqsrsnps_reference_fai_in"
                        },
                        {
                            "file_path": "${samplename}.tmp.snp.vcf",
                            "name": "vqsrsnps_recal_in"
                        },
                        {
                            "file_path": "${samplename}.tranches.gatk.snp.recal.csv",
                            "name": "vqsrsnps_tranches_in"
                        }
                    ],
                    "name": "vqsrsnps",
                    "output_ports": [
                        {
                            "file_path": "${samplename}.vqsr.snp.vcf",
                            "name": "vqsrsnps_out"
                        }
                    ],
                    "resources": {
                        "cores": "1",
                        "memory": "4GB"
                    }
                },
                {
                    "command": "java -Xmx6g -Xms6g -jar /opt/GenomeAnalysisTK.jar -T SelectVariants -R ${reference} -V ${samplename}.gatk.vcf -o ${samplename}.indel.vcf -selectType INDEL",
                    "environment": {
                        "docker_image": "${gatk_container}"
                    },
                    "input_ports": [
                        {
                            "file_path": "${samplename}.gatk.vcf",
                            "name": "selectindelsforvqsr_in"
                        },
                        {
                            "file_path": "${reference}",
                            "name": "selectindelsforvqsr_reference_in"
                        },
                        {
                            "file_path": "${reference}.fai",
                            "name": "selectindelsforvqsr_reference_fai_in"
                        }
                    ],
                    "name": "selectindelsforvqsr",
                    "output_ports": [
                        {
                            "file_path": "${samplename}.indel.vcf",
                            "name": "selectindelsforvqsr_out"
                        }
                    ],
                    "resources": {
                        "cores": "1",
                        "memory": "8GB"
                    }
                },
                {
                    "command": "java -Xmx6g -Xms6g -jar /opt/GenomeAnalysisTK.jar -T VariantRecalibrator -R ${reference} -input ${samplename}.indel.vcf -resource:mills,known=true,training=true,truth=true,prior=12.0 ${goldindels} -an DP -an FS -an MQRankSum -an ReadPosRankSum -tranche 100.0 -tranche 99.9 -tranche 99.0 -tranche 90.0 -mode INDEL -recalFile ${samplename}.tmp.indel.vcf -tranchesFile ${samplename}.tranches.gatk.indel.recal.csv --maxGaussians 4 -nt ${GATKthreads} -rscriptFile ${samplename}.gatk.recal.indel.R",
                    "environment": {
                        "docker_image": "${gatk_container}"
                    },
                    "input_ports": [
                        {
                            "file_path": "${samplename}.indel.vcf",
                            "name": "trainvqsrindels_in"
                        },
                        {
                            "file_path": "${reference}",
                            "name": "trainvqsrindels_reference_in"
                        },
                        {
                            "file_path": "${reference}.fai",
                            "name": "trainvqsrindels_reference_fai_in"
                        },
                        {
                            "file_path": "${goldindels}",
                            "name": "trainvqsrindels_goldindels_in"
                        },
                        {
                            "file_path": "${goldindels}.idx",
                            "name": "trainvqsrindels_goldindels_idx_in"
                        }
                    ],
                    "name": "trainvqsrindels",
                    "output_ports": [
                        {
                            "file_path": "${samplename}.tmp.indel.vcf",
                            "name": "trainvqsrindels_recal_out"
                        },
                        {
                            "file_path": "${samplename}.tranches.gatk.indel.recal.csv",
                            "name": "trainvqsrindels_tranches_out"
                        },
                        {
                            "file_path": "${samplename}.gatk.recal.indel.R",
                            "name": "trainvqsrindels_rscript_out"
                        }
                    ],
                    "resources": {
                        "cores": "${GATKthreads}",
                        "memory": "8GB"
                    }
                },
                {
                    "command": "java -Xmx6g -Xms6g -jar /opt/GenomeAnalysisTK.jar -T ApplyRecalibration -R ${reference} -input ${samplename}.indel.vcf --ts_filter_level 99.0 -tranchesFile ${samplename}.tranches.gatk.indel.recal.csv -recalFile ${samplename}.tmp.indel.vcf -o ${samplename}.vqsr.indel.vcf --mode INDEL",
                    "environment": {
                        "docker_image": "${gatk_container}"
                    },
                    "input_ports": [
                        {
                            "file_path": "${samplename}.indel.vcf",
                            "name": "vqsrindels_in"
                        },
                        {
                            "file_path": "${reference}",
                            "name": "vqsrindels_reference_in"
                        },
                        {
                            "file_path": "${reference}.fai",
                            "name": "vqsrindels_reference_fai_in"
                        },
                        {
                            "file_path": "${samplename}.tmp.indel.vcf",
                            "name": "vqsrindels_recal_in"
                        },
                        {
                            "file_path": "${samplename}.tranches.gatk.indel.recal.csv",
                            "name": "vqsrindels_tranches_in"
                        }
                    ],
                    "name": "vqsrindels",
                    "output_ports": [
                        {
                            "file_path": "${samplename}.vqsr.indel.vcf",
                            "name": "vqsrindels_out"
                        }
                    ],
                    "resources": {
                        "cores": "1",
                        "memory": "8GB"
                    }
                },
                {
                    "command": "java -Xmx8g -Xms8g -jar /opt/GenomeAnalysisTK.jar -R ${reference} -T CombineVariants --variant:VCF ${samplename}.vqsr.indel.vcf --variant:VCF ${samplename}.vqsr.snp.vcf -o genome.recal.vcf",
                    "environment": {
                        "docker_image": "${gatk_container}"
                    },
                    "input_ports": [
                        {
                            "file_path": "${samplename}.vqsr.snp.vcf",
                            "name": "mergecalibratedvcfs_snp_in"
                        },
                        {
                            "file_path": "${samplename}.vqsr.indel.vcf",
                            "name": "mergecalibratedvcfs_indel_in"
                        },
                        {
                            "file_path": "${reference}",
                            "name": "mergecalibratedvcfs_reference_in"
                        },
                        {
                            "file_path": "${reference}.fai",
                            "name": "mergecalibratedvcfs_reference_fai_in"
                        }
                    ],
                    "name": "mergecalibratedvcfs",
                    "output_ports": [
                        {
                            "file_path": "${outputvcffile}",
                            "name": "mergecalibratedvcfs_out"
                        }
                    ],
                    "resources": {
                        "cores": "1",
                        "memory": "10GB"
                    }
                },
                {
                    "command": "bgzip -fc ${outputvcffile} > ${outputvcffile}.gz",
                    "environment": {
                        "docker_image": "${tabix_container}"
                    },
                    "input_ports": [
                        {
                            "file_path": "${outputvcffile}",
                            "name": "compressvcf_in"
                        }
                    ],
                    "name": "compressvcf",
                    "output_ports": [
                        {
                            "file_path": "${outputvcffile}.gz",
                            "name": "compressvcf_out"
                        }
                    ],
                    "resources": {
                        "cores": "1",
                        "memory": "8GB"
                    }
                },
                {
                    "command": "tabix -p vcf ${outputvcffile}.gz",
                    "environment": {
                        "docker_image": "${tabix_container}"
                    },
                    "input_ports": [
                        {
                            "file_path": "${outputvcffile}.gz",
                            "name": "indexcompressedvcf_in"
                        }
                    ],
                    "name": "indexcompressedvcf",
                    "output_ports": [
                        {
                            "file_path": "${outputvcffile}.gz.tbi",
                            "name": "indexcompressedvcf_out"
                        }
                    ],
                    "resources": {
                        "cores": "1",
                        "memory": "8GB"
                    }
                }
            ]
        }
    ]
}
