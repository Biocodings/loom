<source>
  @type forward
  port {{fluentd_port}}
</source>

{% if fluentd_output_plugin == 'file' %}
<match {{server_name}}/*>
  @type file
  path "/fluentd/log/*.log"
  symlink_path "/fluentd/log/docker.log"
  append true
  time_slice_format %Y%m%d
  time_slice_wait 1m
  time_format %Y%m%dT%H%M%S%z
  <buffer time>
    timekey_wait 1m
    timekey 86400
    path /fluentd/log/*.log
  </buffer>
</match>
{% endif %}

{% if fluentd_output_plugin == 'google_cloud' %}
<match **>
  @type google_cloud
</match>
{% endif %}

<match **>
  @type stdout
</match>
